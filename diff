diff --git a/src/math.tex b/src/math.tex
index 7aac8bc..312152d 100644
--- a/src/math.tex
+++ b/src/math.tex
@@ -1,6 +1,31 @@
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 % Contents: Math typesetting with LaTeX
-% $Id: math.tex 169 2008-09-24 07:32:13Z oetiker $
+% $Id: math.tex 182 2008-11-04 09:43:36Z oetiker $
+%
+% Changes by Stefan M. Moser: 2008/10/22
+%
+% -Section 2: "Single Equations": added comment about preference of
+%  equation* over \[
+% -Replaced (almost) all examples with \[ by equation*
+% -New section 4: "Single Equations that are Too Long: multline"
+% -New section 5: "Multiple Equations"
+% -Section 6: "Arrays and Matrices": made a full section and added
+%  some material
+% -Section 9: "Theorems, Lemmas, ...": added a subsection about proofs
+%  with new material
+%
+% Other Changes:
+% -in lshort.sty: 
+%    *example environment adapted: changed in three places
+%     \textwidth by \linewidth. This is necessary for
+%     example-environment within a itemize-list.
+%    *added \RequirePackage[retainorgcmds]{IEEEtrantools}
+%
+% THINGS TO DO:
+% -adapt typesetting of new sections to rest of lshort, including all
+%  the usual commands used so far. In particular, I guess we have to
+%  get rid of the \verb-commands everywhere
+% -include index-commands
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
 \chapter{Typesetting Mathematical Formulae}
@@ -102,7 +127,9 @@ or you can type less for the
 same effect:
  \[ a^2 + b^2 = c^2 \]
 \end{example}
-
+However, note that if you have many equations in a document the
+\LaTeX{} source code will become poorly readable if you use \ci{[} and
+\ci{]}. So we recommend to use \ei{equation} and \ei{equation*}.
 
 Note the difference in typesetting style between \wi{text style} and \wi{display style}
 equations: 
@@ -314,8 +341,10 @@ following commands to typeset the most important function names:
 \end{tabular}
 
 \begin{example}
-\[\lim_{x \rightarrow 0}
- \frac{\sin x}{x}=1\]
+\begin{equation*}
+  \lim_{x \rightarrow 0}
+  \frac{\sin x}{x}=1
+\end{equation*}
 \end{example}
 
 For functions missing from the list, use the \ci{DeclareMathOperator}
@@ -326,7 +355,9 @@ example below must be put into the preamble.
 \begin{example}
 %\DeclareMathOperator{\argh}{argh}
 %\DeclareMathOperator*{\nut}{Nut}
-\[3\argh = 2\nut_{x=1}\]
+\begin{equation*}
+  3\argh = 2\nut_{x=1}    
+\end{equation*}
 \end{example}
 
 For the \wi{modulo function}, there are two commands: \ci{bmod} for the
@@ -346,8 +377,10 @@ Often the slashed form $1/2$ is preferable, because it looks better
 for small amounts of `fraction material:'
 \begin{example}
 In display style:
-\[3/8 \qquad \frac{3}{8} 
- \qquad \tfrac{3}{8} \]
+\begin{equation*}
+  3/8 \qquad \frac{3}{8} 
+  \qquad \tfrac{3}{8}
+\end{equation*}
 \end{example}
 
 \begin{example}
@@ -358,10 +391,12 @@ $1\dfrac{1}{2}$~hours
  
 Here the \ci{partial} command for \wi{partial derivative}s is used:
 \begin{example}
-\[\sqrt{\frac{x^2}{k+1}}\qquad
+\begin{equation*} 
+  \sqrt{\frac{x^2}{k+1}}\qquad
   x^\frac{2}{k+1}\qquad
   \frac{\partial^2f}
-  {\partial x^2} \]
+  {\partial x^2} 
+\end{equation*}
 \end{example}
 
 To typeset \wi{binomial coefficient}s or similar structures, use
@@ -447,82 +482,448 @@ $\big( \Big( \bigg( \Bigg( \quad
  For a list of all delimiters available, see Table~\ref{tab:delimiters} on page
 \pageref{tab:delimiters}. 
 
-\section{Vertically Aligned Material} 
 
-\subsection{Multiple Equations}
+\section{Single Equations that are Too Long: multline}
+\index{long equations}
+\label{sec:multline}
+
+If an equation is too long, we have to wrap it somehow. Unfortunately,
+wrapped equations are usually less easy to read than not wrapped
+ones. To improve the readability, there are certain rules on how to do
+the wrapping:
+\begin{enumerate}
+\item In general one should always wrap an equation \textbf{before} an
+  equality sign or an operator.
+\item A wrap before an equality sign is preferable to a wrap before
+  any operator.
+\item A wrap before a plus- or minus-operator is preferable to a wrap
+  before a multiplication-operator.
+\item Any other type of wrap should be avoided if ever possible.
+\end{enumerate}
+The easiest way to achieve such a wrapping is the use of the
+\ei{multline} en\-vi\-ron\-ment:\footnote{The
+  \texttt{multline}-environment is from \texttt{amsmath}.}
+\begin{example}
+\begin{multline}
+  a + b + c + d + e + f 
+  + g + h + i  
+  \\
+  = j + k + l + m + n 
+\end{multline}
+\end{example}
+\noindent
+The difference to the \ei{equation} environment is that an arbitrary
+line-break (or also multiple line-breaks) can be introduced. This is
+done by putting a \verb+\\+ on those places where the equation needs
+to be wrapped. Similarly to \ei{equation*} there also exists a
+\ei{multline*} version for preventing an equation number.
+
+However, in spite of its ease in use, often the
+\ei{IEEEeqnarray} environment (see section~\ref{sec:IEEEeqnarray})
+will yield better results.  Particularly, consider the following
+common situation:
+\begin{example}
+\begin{equation}
+  a = b + c + d + e + f 
+  + g + h + i + j 
+  + k + l + m + n + o + p  
+  \label{eq:equation_too_long}
+\end{equation}
+\end{example}
+\noindent
+Here it is actually the RHS that is too long to fit on one line. The
+\ei{multline} environment will now yield the following:
+\begin{example}
+\begin{multline}
+  a = b + c + d + e + f 
+  + g + h + i + j \\
+  + k + l + m + n + o + p
+\end{multline}
+\end{example}
+
+This is of course much better than \eqref{eq:equation_too_long}, but
+it has the disadvantage that the equality sign loses its natural
+stronger importance with respect to the plus operator in front of
+$k$. The better solution is provided by the
+\ei{IEEEeqnarray} environment that will be discussed in detail in
+Section~\ref{sec:IEEEeqnarray}: 
+\begin{example}
+\begin{IEEEeqnarray}{rCl}
+  a & = & b + c + d + e + f 
+  + g + h + i + j \nonumber\\
+  && +\: k + l + m + n + o + p 
+  \label{eq:dont_use_multline}
+\end{IEEEeqnarray}
+\end{example}
+In this case the second line is vertically aligned to the first line:
+the $+$ in front of $k$ is exactly below $b$, \emph{i.e.}, the RHS is
+clearly visible as contrast to the LHS of the equation.
+
+
+
+
+\section{Multiple Equations}
 \index{equation!multiple}
+\label{sec:IEEEeqnarray}
+
+In the most general situation we have a sequence of several
+equalities that do not fit onto one line. Here we need to work with
+vertical alignment in order to keep the array of equations in a nice
+and readable structure.
+
+Before we offer our suggestions on how to do this, we start with a few
+bad examples that show the biggest drawbacks of some common solutions.
+
 
-For formulae running over several lines or for \wi{equation system}s,
-you can use the environments \ei{align} and \verb|align*|
-instead of \texttt{equation} and \texttt{equation*}.\footnote{The \ei{align}
-  environment is from \textsf{amsmath}. A similar environment without \textsf{amsmath}
-  from \LaTeX{} is \ei{eqnarray}, but it is generally not advised to use that
-because of spacing and label inconsistencies.} With \ei{align} each line gets an
-equation number. The \verb|align*| does not number anything.
+\subsection{Problems with Traditional Commands}
+\label{sec:problems_traditional}
 
-The \ei{align} environments center the single equation around the \verb|&|
-sign. The \verb|\\| command breaks the lines. If you only want to enumerate some
-of equations, use \ci{nonumber} to remove the number. It has to be placed
-\emph{before} \verb|\\|:
+To group multiple equations the
+\ei{align} environment\footnote{The \texttt{align}-environment can
+  also be used to group several blocks of equations beside each other.
+  However, for this rather rare situation we also recommend to use the
+  \ei{IEEEeqnarray} environment with an argument like,
+  \emph{e.g.}, \texttt{\{rCl+rCl\}}.} could be used:
 \begin{example}
 \begin{align}
-f(x) &= (a+b)(a-b) \label{1}\\
-     &= a^2-ab+ba-b^2  \\ 
-     &= a^2+b^2 \tag{wrong}
+  a & = b + c \\
+  & = d + e
 \end{align}
-This is a reference to \eqref{1}.
 \end{example}
 
-\index{long equations} \textbf{Long equations} will not be
-automatically divided into neat bits.  The author has to specify
-where to break them and correct the indent:
+However, this approach does not work once a single line is too long:
 \begin{example}
 \begin{align}
-f(x) &= 3x^5 + x^4 + 2x^3 
-                \nonumber \\
-     &\qquad + 9x^2 + 12x + 23 \\
-     &= g(x) - h(x)
+  a & = b + c \\
+  & = d + e + f + g + h + i 
+  + j + k + l \nonumber \\
+  & + m + n + o \\
+  & = p + q + r + s
 \end{align}
 \end{example}
-The \pai{amsmath} package provides a couple of other useful environments: \verb|flalign|,
-\verb|gather|, \verb|multline| and \verb|split|. See the
-documentation for the package for a wide range of commands, environments and more.
+\noindent
+Here $+\:m$ should be below $d$ and not below the equality sign. Of
+course, one could add some space by, \emph{e.g.}, \verb+\hspace{...}+,
+but this will never yield a precise arrangement (and is bad
+style\ldots).
 
-\subsection{Arrays and Matrices} \label{sec:arraymat}
+A better solution is offered by the \ei{eqnarray} environment:
+\begin{example}
+\begin{eqnarray}
+  a & = & b + c \\
+  & = & d + e + f + g + h + i 
+  + j + k + l \nonumber \\
+  && +\: m + n + o \\
+  & = & p + q + r + s
+\end{eqnarray}
+\end{example}
+
+The \ei{eqnarray} environment, however, has a few very severe
+disadvantages:
+\begin{itemize}
+\item The spaces around the equality signs are too big.
+  Particularly, they are \textbf{not} the same as in the
+  \ei{multline} and \ei{equation} environments:
+\begin{example}
+\begin{eqnarray}
+  a & = & a = a
+\end{eqnarray}
+\end{example}
+
+\item The expression sometimes overlaps with the equation number even
+  though there would be enough room on the left:
+\begin{example}
+\begin{eqnarray}
+  a & = & b + c 
+  \\
+  & = & d + e + f + g + h^2 
+  + i^2 + j 
+  \label{eq:faultyeqnarray}
+\end{eqnarray}
+\end{example}
+
+\item The environment offers a command \ci{lefteqn} that can
+  be used when the LHS is too long:
+\begin{example}
+\begin{eqnarray}
+  \lefteqn{a + b + c + d 
+    + e + f + g + h}\nonumber\\
+  & = & i + j + k + l + m 
+  \\
+  & = & n + o + p + q + r + s
+\end{eqnarray}
+\end{example}
+Unfortunately, this command is faulty: if the RHS is too short, the array is
+not properly centered:
+\begin{example}
+\begin{eqnarray}
+  \lefteqn{a + b + c + d 
+    + e + f + g + h} 
+  \nonumber \\
+  & = & i + j 
+\end{eqnarray}
+\end{example}
+Moreover, it is very complicated to change the vertical alignment of
+the equality sign on the second line.
+\end{itemize}
+
+Fortunately there is a better way\ldots.
+
+
+\subsection{IEEEeqnarray-Environment}
+\label{sec:IEEEeqnarray_intro}
+
+The \ei{IEEEeqnarray} environment is a very powerful command with
+many options. Here, we will only introduce its basic
+functionalities. For more information we refer to the
+manual.\footnote{The official manual is called
+  \texttt{IEEEtran\_HOWTO.pdf}. The part about \texttt{IEEEeqnarray}
+  can be found in Appendix~F.}
+
+First of all, in order to be able to use the
+\ei{IEEEeqnarray} environment one needs to load the
+package\footnote{This package can be found on CTAN.}
+\pai{IEEEtrantools}. Include the following line in the header of
+your document: \small
+\begin{verbatim}
+\usepackage[retainorgcmds]{IEEEtrantools}
+\end{verbatim}
+\normalsize
+
+The strength of \ei{IEEEeqnarray} is the possibility of specifying
+the number of \emph{columns} in the equation array. Usually, this
+specification will be \verb+{rCl}+, \emph{i.e.}, three columns, the
+first column right-justified, the middle one centered with a little
+more space around it (therefore we specify capital \texttt{C} instead of
+lower-case \texttt{c}) and the third column left-justified:
+\begin{example}
+\begin{IEEEeqnarray}{rCl}
+  a & = & b + c 
+  \\
+  & = & d + e + f + g + h 
+  + i + j + k \nonumber\\
+  && +\: l + m + n + o 
+  \\
+  & = & p + q + r + s
+\end{IEEEeqnarray}
+\end{example}
+
+However, we can specify any number of needed columns. \emph{E.g.},
+\texttt{{c}} will give only one column with all entries centered, or
+\verb+{rCll}+ will add a fourth, left-justified column, \emph{e.g.},
+for comments. Moreover, beside \texttt{l}, \texttt{c}, \texttt{r}, \texttt{L},
+\texttt{C}, \texttt{R} for math mode entries there also exists \texttt{s},
+\texttt{t}, \texttt{u} for left, centered, and right text mode entries,
+respectively. Moreover, we can add additional space by \texttt{.} and
+\texttt{/} and \texttt{?} in increasing order.\footnote{For more spacing
+  types we refer to Section~\ref{sec:putting-qed-right} and the
+  official manual.}
+
+Note that in contrast to \texttt{eqnarry} the spaces around the equality
+signs are correct!
+
+\subsection{Common Usage}
+\label{sec:common-usage}
+
+In the following we will describe how we use \texttt{IEEEeqnarray} to
+solve the most common situations.
+\begin{itemize}
+\item If a line overlaps with the equation number as in
+  \eqref{eq:faultyeqnarray}, the command 
+\small
+\begin{verbatim}
+\IEEEeqnarraynumspace
+\end{verbatim} 
+\normalsize
+  can be used: it has to be added in the corresponding line and makes
+  sure that the whole equation array is shifted by the size of the
+  equation numbers (the shift depends on the size of the number!):
+  instead of
+\begin{example}
+\begin{IEEEeqnarray}{rCl}
+  a & = & b + c 
+  \\
+  & = & d + e + f + g + h 
+  + i + j + k 
+  \\
+  & = & l + m + n
+\end{IEEEeqnarray}
+\end{example}
+  we get
+\begin{example}
+\begin{IEEEeqnarray}{rCl}
+  a & = & b + c 
+  \\
+  & = & d + e + f + g + h 
+  + i + j + k 
+  \IEEEeqnarraynumspace\\
+  & = & l + m + n.
+\end{IEEEeqnarray}
+\end{example}
+
+\item If the LHS is too long, as a replacement for the faulty
+  \ci{lefteqn} command, \texttt{IEEEeqnarray} offers the
+  \ci{IEEEeqnarraymulticol} command which works in all situations:
+\begin{example}
+\begin{IEEEeqnarray}{rCl}
+  \IEEEeqnarraymulticol{3}{l}{
+    a + b + c + d + e + f 
+    + g + h
+  }\nonumber\\ \quad
+  & = & i + j 
+  \\
+  & = & k + l + m
+\end{IEEEeqnarray}
+\end{example}
+The usage is identical to the \ci{multicolumns} command in the
+\texttt{tabular}-en\-vi\-ron\-ment. The first argument \verb+{3}+
+specifies that three columns shall be combined to one which will be
+left-justified \verb+{l}+.
+
+Note that by adapting the \ci{quad} command one can easily adapt
+the depth of the equation signs,\footnote{I think that one quad is the
+  distance that looks good for most cases.} \emph{e.g.},
+\begin{example}
+\begin{IEEEeqnarray}{rCl}
+  \IEEEeqnarraymulticol{3}{l}{
+    a + b + c + d + e + f 
+    + g + h
+  }\nonumber\\ \qquad\qquad
+  & = & i + j
+  \\
+  & = & k + l + m
+\end{IEEEeqnarray}
+\end{example}
+
+\item If an equation is split into two or more lines, \LaTeX\
+  interprets the first $+$ or $-$ as sign instead of operator.
+  Therefore, it is necessary to add an additional space \ci{:}
+  between the operator and the term: instead of
+\begin{example}
+\begin{IEEEeqnarray}{rCl}
+  a & = & b + c 
+  \\
+  & = & d + e + f + g + h 
+  + i + j + k \nonumber\\
+  && + l + m + n + o 
+  \\
+  & = & p + q + r + s
+\end{IEEEeqnarray}
+\end{example}
+  we should write
+\begin{example}
+\begin{IEEEeqnarray}{rCl}
+  a & = & b + c 
+  \\
+  & = & d + e + f + g + h 
+  + i + j + k \nonumber\\
+  && +\: l + m + n + o 
+  \\
+  & = & p + q + r + s
+\end{IEEEeqnarray}
+\end{example}
+  (Compare the space between $+$ and $l$!)
+  
+  \textbf{Attention:} \LaTeX\ is not completely silly: in certain
+  situations like, \emph{e.g.}, in front of
+  \begin{itemize}
+  \item an operator name like \ci{log}, \ci{sin}, \ci{det},
+    \ci{max}, \emph{etc.},
+  \item an integral \ci{int} or sum \ci{sum},
+  \item a bracket with adaptive size using \ci{left} and
+      \ci{right} (this is in contrast to normal brackets or
+    brackets with fixed size like \ci{big(} ),
+  \end{itemize}
+  a $+$ or $-$ cannot be a sign, but must be an operator. In those
+  situations \LaTeX\ will add the correct spacing and no additional
+  space is needed.
+  \begin{itemize}
+  \item[$\rhd$] \it Whenever you wrap a line, quickly check the result
+    and verify that the spacing is correct!
+  \end{itemize}
+
+\item If a particular line should not have an equation number, the
+  number can be suppressed using \ci{nonumber} (or
+  \ci{IEEEnonumber}). If on such a line a label
+  \verb+\label{eq:...}+ is defined, then this label is passed on
+  further to the next equation number that is not suppressed. However,
+  it is recommended to put the labels right before the line-break
+  \verb+\\+ or the end of the equation it belongs to. Apart from
+  improving the readability of the source code this prevents a
+  compilation error in the situation of a \ci{IEEEmulticol} command
+  after the label-definition.
+  
+\item There also exists a *-version where all equation numbers are
+  suppressed. In this case an equation number can be made to appear
+  using the command \ci{IEEEyesnumber}:
+\begin{example}
+\begin{IEEEeqnarray*}{rCl}
+  a & = & b + c \\
+  & = & d + e \IEEEyesnumber\\
+  & = & f + g
+\end{IEEEeqnarray*}
+\end{example}
+
+\item Sub-numbers are also easily possible using 
+  \ci{IEEEyessubnumber}:
+\begin{example}
+\begin{IEEEeqnarray}{rCl}
+  a & = & b + c 
+  \IEEEyessubnumber\\
+  & = & d + e 
+  \nonumber\\
+  & = & f + g 
+  \IEEEyessubnumber  
+\end{IEEEeqnarray}
+\end{example}
+  
+\end{itemize}
+
+
+
+\section{Arrays and Matrices} \label{sec:arraymat}
 
 To typeset \textbf{arrays}, use the \ei{array} environment. It works
 somewhat similar to the \texttt{tabular} environment. The \verb|\\| command is
 used to break the lines:
 \begin{example}
-\begin{equation*}
- \mathbf{X} = \left( 
-  \begin{array}{ccc}
-   x_1 & x_2 & \ldots \\
-   x_3 & x_4 & \ldots \\
-   \vdots & \vdots & \ddots
-  \end{array} \right)
-\end{equation*}
+  \begin{equation*}
+    \mathbf{X} = \left( 
+      \begin{array}{ccc}
+        x_1 & x_2 & \ldots \\
+        x_3 & x_4 & \ldots \\
+        \vdots & \vdots & \ddots
+      \end{array} \right)
+  \end{equation*}
 \end{example}
 
-
 The \ei{array} environment can also be used to typeset \wi{piecewise function}s by
-using a ``\verb|.|'' as an invisible \ci{right} delimiter:\footnote{If you want
-  to typeset a lot of constructions like these, the \ei{cases} environment from
-  \textsf{amsmath} simplifies the syntax, so it is worth a look.}  
+using a ``\verb|.|'' as an invisible \ci{right} delimiter:
 \begin{example}
 \begin{equation*}
-|x| = \left\{
- \begin{array}{rl}
-  -x & \text{if } x < 0\\
-   0 & \text{if } x = 0\\
-   x & \text{if } x > 0
- \end{array} \right.
+  |x| = \left\{
+    \begin{array}{rl}
+      -x & \text{if } x < 0,\\
+      0 & \text{if } x = 0,\\
+      x & \text{if } x > 0.
+    \end{array} \right.
+\end{equation*}
+\end{example}
+However the \ei{cases} environment from \textsf{amsmath} simplifies
+the syntax, so it is worth a look:
+\begin{example}
+  \begin{equation*}
+    |x| = 
+    \begin{cases}
+      -x & \text{if } x < 0,\\
+      0 & \text{if } x = 0,\\
+      x & \text{if } x > 0.
+    \end{cases} 
 \end{equation*}
 \end{example}
 
 
-
-\ei{array} can be used to typeset matrices\index{matrix} as well, but
+Matrices\index{matrix} can also be typeset by \ei{array}, but
 \pai{amsmath} provides a better solution using the different \ei{matrix}
 environments. There are six versions with different delimiters: \ei{matrix}
 (none), \ei{pmatrix} $($, \ei{bmatrix} $[$, \ei{Bmatrix} $\{$, \ei{vmatrix} $\vert$ and
@@ -531,15 +932,20 @@ environments. There are six versions with different delimiters: \ei{matrix}
 very often you need 10 columns!):
 \begin{example}
 \begin{equation*}
- \begin{matrix} 
-   1 & 2 \\
-   3 & 4 
- \end{matrix} \qquad
- \begin{bmatrix} 
-   1 & 2 & 3 \\
-   4 & 5 & 6 \\ 
-   7 & 8 & 9
- \end{bmatrix}
+  \begin{matrix} 
+    1 & 2 \\
+    3 & 4 
+  \end{matrix} \qquad
+  \begin{bmatrix} 
+    p_{11} & p_{12} & \ldots 
+    & p_{1n} \\
+    p_{21} & p_{22} & \ldots 
+    & p_{2n} \\
+    \vdots & \vdots & \ddots 
+    & \vdots \\
+    p_{m1} & p_{m2} & \ldots 
+    & p_{mn} 
+  \end{bmatrix}
 \end{equation*}
 \end{example}
 
@@ -592,11 +1000,13 @@ commands.
 \begin{example}
 \newcommand{\ud}{\,\mathrm{d}}
 
-\[ \int\int f(x)g(y) 
-                  \ud x \ud y \]
-\[ \int\!\!\!\int 
-         f(x)g(y) \ud x \ud y \]
-\[ \iint f(x)g(y) \ud x \ud y \]
+\begin{IEEEeqnarray*}{c}
+  \int\int f(x)g(y) 
+                  \ud x \ud y \\
+  \int\!\!\!\int 
+         f(x)g(y) \ud x \ud y \\
+  \iint f(x)g(y)  \ud x \ud y 
+\end{IEEEeqnarray*}
 \end{example}
 
 See the electronic document \texttt{testmath.tex} (distributed with
@@ -643,12 +1053,12 @@ If $\sum$ is placed in a fraction, it'll be typeset in text style unless you tel
 \LaTeX{} otherwise:
 \begin{example}
 \begin{equation*}
- R = \frac{\displaystyle{ 
-   \sum_{i=1}^n (x_i-\bar{x})
-   (y_i- \bar{y})}} 
+ P = \frac{\displaystyle{ 
+   \sum_{i=1}^n (x_i- x)
+   (y_i- y)}} 
    {\displaystyle{\left[
-   \sum_{i=1}^n(x_i-\bar{x})^2
-   \sum_{i=1}^n(y_i-\bar{y})^2
+   \sum_{i=1}^n(x_i-x)^2
+   \sum_{i=1}^n(y_i- y)^2
    \right]^{1/2}}}
 \end{equation*}    
 \end{example}
@@ -764,12 +1174,21 @@ The ``Murphy'' theorem gets a number that is linked to the number of
 the current section. You could also use another unit, for example chapter or
 subsection.
 
+If you want to customize your theorems down to the last dot, the
+\pai{ntheorem} package offers a plethora of options.
+
+
+\subsection{Proofs and End-of-Proof Symbol}
+\label{sec:putting-qed-right}
+
 The \pai{amsthm} package also provides the \ei{proof} environment.
 
 \begin{example}
 \begin{proof}
  Trivial, use
-\[E=mc^2\]
+ \begin{equation*}
+   E=mc^2.
+ \end{equation*}
 \end{proof}
 \end{example}
 
@@ -779,12 +1198,104 @@ around for situations where it would end up alone on a line.
 \begin{example}
 \begin{proof}
  Trivial, use
-\[E=mc^2 \qedhere\]
+ \begin{equation*}
+   E=mc^2. \qedhere
+ \end{equation*}
 \end{proof}
 \end{example}
 
-If you want to customize your theorems down to the last dot, the
-\pai{ntheorem} package offers a plethora of options.
+Unfortunately, this correction does not work for \texttt{IEEEeqnarray}:
+\begin{example}
+\begin{proof}
+  This is a proof that ends
+  with an equation array:
+  \begin{IEEEeqnarray*}{rCl}
+    a & = & b + c \\
+    & = & d + e. \qedhere
+  \end{IEEEeqnarray*}  
+\end{proof}
+\end{example}
+\noindent
+The reason for this is the internal structure of \texttt{IEEEeqnarray}:
+it always puts two invisible columns at both sides of the array that
+only contain a stretchable space. By this \texttt{IEEEeqnarray} ensures
+that the equation array is horizontally centered. The
+\ci{qedhere} command should actually be put \emph{outside} this
+stretchable space, but this does not happen as these columns are
+invisible to the user.
+
+There is, however, a very simple remedy: we define these stretching
+columns ourselves!
+\begin{example}
+\begin{proof}
+  This is a proof that ends
+  with an equation array:
+  \begin{IEEEeqnarray*}{+rCl+x*}
+    a & = & b + c \\
+    & = & d + e. & \qedhere
+  \end{IEEEeqnarray*}  
+\end{proof}
+\end{example}
+\noindent
+Note that the \verb=+= in \verb={+rCl+x*}= denotes stretchable spaces, one
+on the left of the equations (which, if not specified, will be done
+automatically by \texttt{IEEEeqnarray}!) and one on the right of the
+equations. But now on the right, \emph{after} the stretching column,
+we add an empty column \verb=x=. This column will be only needed on
+the last line when we will put the \ci{qedhere} command
+there. Finally, we specify a \verb=*=. This is a null-space that
+prevents \texttt{IEEEeqnarray} to add another unwanted \verb=+=-space!
+
+In case of equation numbering, we have a similar problem. If you compare
+\begin{example}
+\begin{proof}
+  This is a proof that ends
+  with a numbered equation:
+  \begin{equation}
+    a = b + c.
+  \end{equation}
+\end{proof}
+\end{example}
+\noindent
+with
+\begin{example}
+\begin{proof}
+  This is a proof that ends
+  with a numbered equation:
+  \begin{equation}
+    a = b + c. \qedhere
+  \end{equation}
+\end{proof}
+\end{example}
+\noindent
+you notice that in the (correct) second version the $\Box$ is much
+closer to the equation than in the first version.
+
+Similarly, the correct way of putting the QED-symbol at the end of an
+equation array is as follows:
+\begin{example}
+\begin{proof}
+  This is a proof that ends
+  with an equation array:
+  \begin{IEEEeqnarray}{+rCl+x*}
+    a & = & b + c \\
+    & = & d + e. \\
+    &&& \qedhere\nonumber
+  \end{IEEEeqnarray}  
+\end{proof}
+\end{example}
+\noindent
+which contrasts with
+\begin{example}
+\begin{proof}
+  This is a proof that ends
+  with an equation array:
+  \begin{IEEEeqnarray}{rCl}
+    a & = & b + c \\
+    & = & d + e.
+  \end{IEEEeqnarray}  
+\end{proof}
+\end{example}
 
 
 %
